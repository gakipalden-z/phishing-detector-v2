{% extends 'base.html' %}
{% block content %}
<h1>Admin Overview</h1>
<p class="muted">Recent email analyses and audit log events (admin-only).</p>

<div class="grid-2">
  <div class="card">
    <h2>Recent Analyses</h2>
    {% if analyses %}
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>User ID</th>
            <th>Score</th>
            <th>Level</th>
            <th>Quarantined</th>
            <th>Time</th>
          </tr>
        </thead>
        <tbody>
          {% for it in analyses %}
          <tr>
            <td>{{ it.id }}</td>
            <td>{{ it.user_id }}</td>
            <td>{{ it.risk_score }}</td>
            <td>{{ it.risk_level }}</td>
            <td>{{ 'Yes' if it.quarantined else 'No' }}</td>
            <td>{{ it.created_at }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="muted">No analyses yet.</p>
    {% endif %}
  </div>

  <div class="card">
    <h2>Audit Log (Latest Events)</h2>
    {% if logs %}
      <table>
        <thead>
          <tr>
            <th>Time</th>
            <th>User ID</th>
            <th>Event</th>
            <th>Detail</th>
            <th>IP</th>
          </tr>
        </thead>
        <tbody>
          {% for l in logs %}
          <tr>
            <td>{{ l.created_at }}</td>
            <td>{{ l.user_id or '' }}</td>
            <td>{{ l.event }}</td>
            <td>{{ l.detail or '' }}</td>
            <td>{{ l.ip_address or '' }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="muted">No audit events yet.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
